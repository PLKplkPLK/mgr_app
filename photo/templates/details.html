{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PrzeglÄ…danie zdjÄ™Ä‡</title>
    <link rel="stylesheet" href="{% static 'photo/style.css' %}">
</head>

<body>
    <div class="buttons-container">
        <a class="button" href="{% url 'gallery:browse' %}">PrzejdÅº do galerii</a>
        <a class="button" href="{% url 'account:settings' %}">PrzejdÅº do ustawieÅ„</a>
        <a class="button" href="{% url 'photo:upload' %}">WyÅ›lij zdjÄ™cie</a>
    </div>

    <div class="upload-container">
        <img src="{{ photo.image.url }}" id="image" alt="Twoje zdjÄ™cie">
        <p>Data dodania: {{photo.upload_time}}</p>
        {% if photo.is_private %}
        <p>ZdjÄ™cie jest prywatne</p>
        {% else %}
        <p>ZdjÄ™cie jest publiczne</p>
        {% endif %}

        {% if photo.owner == user %}
        <form method="post" action="{% url 'photo:toggle_photo_privacy' photo.uuid %}">
            {% csrf_token %}
            <button type="submit">
                {% if photo.is_private %}ZmieÅ„ zdjÄ™cie na publiczne{% else %}ZmieÅ„ zdjÄ™cie na prywatne{% endif %}
            </button>
        </form>
        {% endif %}

        {% if prediction_1 %}
        <p>Wykryto na zdjÄ™ciu: {{ prediction_1 }}</p>
        {% else %}
        <p>Klasyfikacja zwierzÄ™cia jeszcze siÄ™ nie zakoÅ„czyÅ‚a, lub wystÄ…piÅ‚ bÅ‚Ä…d.</p>
        {% endif %}

        {% if photo.owner == user %}
            <form method="post" action="{% url 'photo:delete_photo' photo.uuid %}" onsubmit="return confirm('JesteÅ› pewien, Å¼e chcesz usunÄ…Ä‡ zdjÄ™cie?');">
                {% csrf_token %}
                <button type="submit">âŒ UsuÅ„ zdjÄ™cie</button>
            </form>
        {% endif %}

        {% if photo.owner == user %}
        <form method="post" action="{% url 'photo:toggle_review' photo.uuid %}">
            {% csrf_token %}
            <button type="submit">
                {% if photo.review_status != 1 %}Oznacz zdjÄ™cie do sprawdzenia{% else %}Oznacz zdjÄ™cie jako sprawdzone{% endif %}
            </button>
        </form>
        {% endif %}

        {% if photo.review_status == 0 %}
            ZdjÄ™cie nie byÅ‚o sprawdzane.
        {% elif photo.review_status == 1 and photo.is_private %}
            <p style="color: red">ZdjÄ™cie musi byÄ‡ publiczne, aby mogÅ‚o byÄ‡ sprawdzone przez innych uÅ¼ytkownikÃ³w</p>
        {% else %}
            <form method="post" action="{% url 'photo:post_review' photo.uuid %}">
                {% csrf_token %}
                {{ post_review_form }}
                <button type="submit">Dodaj</button>
            </form>

            {% if reviews %}
                {% for review in reviews %}
                    <div class='review'>
                        <div class='review_upper'>
                            {{ review.owner.username }} | {{ review.upload_time }}

                            {% if photo.owner == user %}
                                <form method="post" action="{% url 'photo:toggle_helpful' review.id %}">
                                    {% csrf_token %}
                                    <button type="submit">
                                        {% if review.helpful %} âœ… Odznacz pomocnoÅ›Ä‡ {% else %} ğŸŸ© Pomocny komentarz {% endif %}
                                    </button>
                                </form>
                            {% else %}
                                {% if review.helpful %}
                                    <p style="color:green">âœ… Pomocny komentarz</p>
                                {% endif %}
                            {% endif %}

                            {% if review.owner == user %}
                                <form method="post" action="{% url 'photo:delete_review' review.id %}" onsubmit="return confirm('JesteÅ› pewien, Å¼e chcesz usunÄ…Ä‡ ten komentarz?');">
                                    {% csrf_token %}
                                    <button type="submit">ğŸ—‘ï¸</button>
                                </form>
                            {% endif %}
                        </div>
                        <div class='review_main'>
                            {{ review.review }}
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p>Jeszcze nikt nie pomÃ³gÅ‚, moÅ¼esz byÄ‡ pierwszy :)</p>
            {% endif %}
        {% endif %}
    </div>
</body>
</html>
